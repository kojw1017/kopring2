# 요구사항 명세서

## 프로젝트 개요

본 프로젝트는 e-커머스 상품 주문 서비스를 구현합니다. 사용자는 상품을 조회하고, 선택한 상품을 장바구니에 담아 결제할 수 있습니다. 결제는 미리 충전한 잔액을 이용하여 이루어집니다. 또한 판매량이 높은 상품을 추천받을 수 있습니다.

## 핵심 요구사항

### 1. 잔액 충전 / 조회 기능
- 사용자는 결제에 사용될 금액을 충전할 수 있어야 합니다.
- 사용자는 본인의 현재 잔액을 조회할 수 있어야 합니다.
- 충전 금액은 0보다 커야 합니다.

### 2. 상품 조회 기능
- 모든 상품 목록을 조회할 수 있어야 합니다.
- 개별 상품의 상세 정보를 조회할 수 있어야 합니다.
- 상품 정보에는 ID, 이름, 가격, 현재 재고 수량이 포함되어야 합니다.
- 조회 시점의 정확한 재고 수량이 표시되어야 합니다.

### 3. 주문 / 결제 기능
- 사용자는 여러 상품을 한 번에 주문할 수 있어야 합니다.
- 주문 시 사용자 식별자와 각 상품의 ID 및 수량이 필요합니다.
- 결제는 사용자가 미리 충전한 잔액으로 이루어져야 합니다.
- 잔액이 부족하면 주문이 실패해야 합니다.
- 재고가 부족하면 주문이 실패해야 합니다.
- 결제 성공 시 해당 상품의 재고가 감소해야 합니다.
- 결제 성공 시 실시간으로 주문 정보를 데이터 플랫폼에 전송해야 합니다.

### 4. 인기 상품 조회 기능
- 최근 3일간 가장 많이 팔린 상위 5개 상품 정보를 제공해야 합니다.
- 상품 판매량에 따라 순위를 매겨 제공해야 합니다.

### 5. 장바구니 기능
- 사용자는 구매 이전에 상품을 장바구니에 추가할 수 있어야 합니다.
- 장바구니에 있는 상품의 수량을 변경할 수 있어야 합니다.
- 장바구니에서 상품을 삭제할 수 있어야 합니다.
- 장바구니에 담긴 모든 상품 목록을 조회할 수 있어야 합니다.

## 비기능적 요구사항

### 1. 성능 및 확장성
- 다수의 인스턴스로 애플리케이션이 동작하더라도 기능에 문제가 없어야 합니다.
- 동시에 여러 주문이 들어올 경우에도 사용자의 잔액 처리가 정확해야 합니다.
- 각 상품의 재고 관리가 정상적으로 이루어져야 합니다.

### 2. 보안
- 사용자 정보는 안전하게 관리되어야 합니다.
- 결제 정보는 안전하게 처리되어야 합니다.

### 3. 테스트
- 각 기능 및 제약사항에 대해 단위 테스트를 하나 이상 작성해야 합니다.
- 동시성 이슈에 대한 테스트가 포함되어야 합니다.

## 기술 요구사항

- Spring Boot 기반의 RESTful API로 구현합니다.
- JPA를 사용한 데이터 액세스 레이어를 구현합니다.
- H2 인메모리 데이터베이스를 사용합니다.
- 동시성 제어를 위해 @Synchronized 어노테이션과 데이터베이스 락을 활용합니다.
- 비동기 처리를 위해 @Async 어노테이션을 사용합니다.
